<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>MuscleBoss</title>
<link rel="icon" href="icon-192.png" type="image/png">
  <meta name="theme-color" content="#111111">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <style>
    :root { --bg:#0f0f10; --fg:#f5f5f7; --muted:#a0a0a6; --accent:#42b883; --card:#1a1b1e; }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);font-family:-apple-system, BlinkMacSystemFont, "SF Pro Text", Inter, Roboto, Segoe UI, Arial, sans-serif}
    header{position:sticky;top:0;background:var(--bg);padding:14px 16px;border-bottom:1px solid #222;z-index:10}
    h1{font-size:20px;margin:0}
    .tabs{display:flex;gap:8px;padding:8px;position:sticky;top:56px;background:var(--bg);border-bottom:1px solid #222;z-index:9}
    .tab{flex:1;padding:10px;border-radius:10px;background:var(--card);text-align:center;color:var(--muted);cursor:pointer;user-select:none}
    .tab.active{color:var(--fg);outline:2px solid #2a2a2a}
    main{padding:16px;padding-bottom:100px}
    section{display:none}
    section.active{display:block}
    .card{background:var(--card);border:1px solid #222;border-radius:14px;padding:14px;margin-bottom:14px}
    .title{font-weight:700;margin:0 0 6px 0}
    .sub{color:var(--muted);font-size:13px;margin:0 0 8px 0}
    .exercise{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px dashed #2a2a2a}
    .exercise:last-child{border-bottom:none}
    .btn{display:inline-block;background:var(--accent);color:#081b12;border:none;border-radius:12px;padding:10px 14px;font-weight:700;cursor:pointer}
    .btn.ghost{background:#242628;color:var(--fg)}
    .row{display:flex;gap:10px;align-items:center}
    input[type="checkbox"]{width:20px;height:20px}
    input[type="number"], input[type="text"]{width:100%;background:#101114;border:1px solid #2a2a2a;color:var(--fg);border-radius:10px;padding:10px}
    label{font-size:13px;color:var(--muted)}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .small{font-size:12px;color:var(--muted)}
    .center{display:flex;justify-content:center;align-items:center}
    .hint{font-size:12px;color:#8aa; margin-top:8px}
    footer{position:fixed;bottom:0;left:0;right:0;padding:12px;background:linear-gradient(180deg, transparent, rgba(15,15,16,0.9));backdrop-filter: blur(6px)}
  </style>
</head>
<body>
  <header><h1>MuscleBoss</h1></header>

  <nav class="tabs">
    <div class="tab active" data-tab="train">Entraînement</div>
    <div class="tab" data-tab="meals">Repas</div>
    <div class="tab" data-tab="shop">Courses</div>
    <div class="tab" data-tab="progress">Progression</div>
  </nav>

  <main>
    <!-- TRAINING -->
    <section id="train" class="active">
      <div id="workouts"></div>
      <div class="card">
        <div class="title">Rappels</div>
        <p class="small">Ajoute +1 rep ou +1 kg chaque semaine sur les exos de base. Repos 2–3 min en lourd, contrôle en 10–15 reps.</p>
      </div>
    </section>

    <!-- MEALS -->
    <section id="meals">
      <div id="mealplan"></div>
      <div class="hint">Sans oignons ni cucurbitacées. Saumon 1×/semaine.</div>
    </section>

    <!-- SHOPPING -->
    <section id="shop">
      <div class="card row" style="justify-content:space-between;">
        <div>
          <div class="title">Liste de courses</div>
          <div class="small">Tap pour cocher. Bouton pour réinitialiser.</div>
        </div>
        <button class="btn ghost" id="resetShop">Réinitialiser</button>
      </div>
      <div id="shopping"></div>
      <div class="card small">Budget Varna estimé ~62,30 € / semaine (hors whey).</div>
    </section>

    <!-- PROGRESS -->
    <section id="progress">
      <div class="card">
        <div class="title">Ajouter une entrée</div>
        <div class="grid">
          <div><label>Poids (kg)</label><input id="bw" type="number" inputmode="decimal" placeholder="77"></div>
          <div><label>Bench (kg)</label><input id="bench" type="number" inputmode="decimal" placeholder="80"></div>
          <div><label>Squat (kg)</label><input id="squat" type="number" inputmode="decimal" placeholder="110"></div>
          <div><label>Deadlift (kg)</label><input id="deadlift" type="number" inputmode="decimal" placeholder="140"></div>
          <div><label>OHP (kg)</label><input id="ohp" type="number" inputmode="decimal" placeholder="50"></div>
        </div>
        <div style="height:10px"></div>
        <button class="btn" id="saveLog">Enregistrer</button>
      </div>
      <div id="logs"></div>
    </section>
  </main>

  <footer class="center small">Ajoute-la à l’écran d’accueil : Partager → « Sur l’écran d’accueil »</footer>

  <script>
  // --- Data ---
  const workouts = [
    { title: "Jour 1 – Haut (Force & Volume)", focus:"Pecs/Dos/Épaules/Bras", key:"j1", exercises:[
      ["Développé couché barre","4","6–8","2–3 min"],
      ["Tractions pronation / tirage","4","6–8","2–3 min"],
      ["Développé militaire haltères","3","8–10",""],
      ["Rowing barre","3","8–10",""],
      ["Curl barre EZ","3","10–12",""],
      ["Extensions triceps poulie","3","10–12",""]
    ]},
    { title: "Jour 2 – Bas (Force & Volume)", focus:"Quadris/Ischios/Mollets/Gainage", key:"j2", exercises:[
      ["Squat barre","4","6–8","2–3 min"],
      ["SDT jambes tendues","3","8–10",""],
      ["Fentes marchées","3","10/jambe",""],
      ["Mollets debout lourd","4","12–15",""],
      ["Gainage lesté","3","60 s",""]
    ]},
    { title: "Jour 3 – Haut (Volume & Iso)", focus:"Pecs/Dos/Épaules/Bras", key:"j3", exercises:[
      ["Développé incliné haltères","4","8–10",""],
      ["Tractions supination","4","8–10",""],
      ["Élévations latérales","4","12–15",""],
      ["Rowing unilatéral haltère","3","10–12",""],
      ["Curl incliné","3","10–12",""],
      ["Barre au front","3","10–12",""]
    ]},
    { title: "Jour 4 – Bas (Volume & Iso)", focus:"Quadris/Fessiers/Ischios/Mollets", key:"j4", exercises:[
      ["Presse à cuisses lourde","4","8–10",""],
      ["Hip thrust","3","10–12",""],
      ["SDT sumo léger","3","10–12",""],
      ["Mollets assis","4","15–20",""],
      ["Planche latérale lestée","3","45 s/côté",""]
    ]}
  ];

  const mealPlan = [
    ["Jour 1",
      ["Petit-déj", ["Flocons d’avoine 100 g","Lait 300 ml","Whey 30 g","Beurre de cacahuète 20 g","Banane 1"]],
      ["Déjeuner", ["Poulet 150 g","Riz basmati 200 g cuit","Brocoli + carottes","Huile d’olive 15 g"]],
      ["Dîner (x2)", ["Maquereau conserve 2×200 g","Pommes de terre 500 g","Haricots verts 300 g","Huile d’olive 10 g"]]
    ],
    ["Jour 2",
      ["Petit-déj", ["Œufs 3","Pain complet 100 g","Fromage 30 g","Pomme 1"]],
      ["Déjeuner", ["Steak haché 150 g","Pâtes complètes 200 g","Épinards vapeur","Huile de colza 15 g"]],
      ["Dîner (x2)", ["Cabillaud/Colin 2×200 g","Riz jasmin 300 g","Brocoli","Noix de cajou 20 g"]]
    ],
    ["Jour 3",
      ["Petit-déj", ["Flocons d’avoine 120 g","Lait 300 ml","Whey 30 g","Amandes 30 g"]],
      ["Déjeuner", ["Dinde 150 g","Pommes de terre 200 g","Carottes + haricots verts","Huile de colza 15 g"]],
      ["Dîner (x2)", ["Sardines conserve 2×200 g","Pâtes semi-complètes 300 g","Épinards/Brocoli","Huile d’olive 15 g"]]
    ],
    ["Jour 4",
      ["Petit-déj", ["Œufs 4","Pain complet 150 g","Avocat 1"]],
      ["Déjeuner", ["Poulet rôti 150 g","Riz basmati 200 g","Haricots verts","Huile d’olive 15 g"]],
      ["Dîner saumon (x2)", ["Saumon 2×200 g","Pommes de terre 500 g","Brocoli","Amandes 20 g"]]
    ],
    ["Jour 5",
      ["Petit-déj", ["Flocons d’avoine 100 g","Lait 300 ml","Whey 30 g","Beurre de cacahuète 20 g","Banane 1"]],
      ["Déjeuner", ["Bœuf haché 150 g","Pâtes complètes 200 g","Carottes + haricots verts","Huile de colza 15 g"]],
      ["Dîner (x2)", ["Cabillaud/Colin 2×200 g","Pommes de terre 500 g","Brocoli","Huile d’olive 10 g"]]
    ],
    ["Jour 6",
      ["Petit-déj", ["Œufs 3","Pain complet 100 g","Fromage 30 g","Pomme 1"]],
      ["Déjeuner", ["Dinde 150 g","Riz basmati 200 g","Épinards vapeur","Huile d’olive 15 g"]],
      ["Dîner (x2)", ["Sardines conserve 2×200 g","Pommes de terre 500 g","Haricots verts","Noix 20 g"]]
    ],
    ["Jour 7",
      ["Petit-déj", ["Flocons d’avoine 120 g","Lait 300 ml","Whey 30 g","Noix 30 g"]],
      ["Déjeuner", ["Steak haché 150 g","Pâtes complètes 200 g","Brocoli vapeur","Huile d’olive 15 g"]],
      ["Dîner (x2)", ["Maquereau conserve 2×200 g","Pommes de terre 500 g","Haricots verts","Huile de colza 15 g"]]
    ]
  ];

  const shoppingDefaults = [
    // Cereals
    ["Flocons d’avoine","500 g"],["Lait","3 L"],["Beurre de cacahuète","250 g"],["Fruits à coque (amandes/noix/cajou)","200 g"],
    // Proteins
    ["Filets de poulet","1,2 kg"],["Steak haché bœuf maigre","1 kg"],["Saumon frais","200 g"],["Cabillaud/Colin","400 g"],
    ["Conserves poisson (maquereau/sardines/thon)","600 g"],
    // Dairy & eggs
    ["Œufs","12 unités"],["Fromage","200 g"],
    // Carbs
    ["Riz","1 kg"],["Pâtes","1 kg"],["Pommes de terre","2 kg"],["Patates douces","1 kg"],
    // Fruits & veg
    ["Pommes","1 kg"],["Bananes","1 kg"],["Brocolis","500 g"],["Carottes","500 g"],["Haricots verts","500 g"],
    ["Épinards","500 g"],["Avocat","1"],["Citron","1"]
  ];

  // --- Tabs ---
  const tabs = document.querySelectorAll('.tab');
  const sections = document.querySelectorAll('section');
  tabs.forEach(t => t.addEventListener('click', () => {
    tabs.forEach(x => x.classList.remove('active'));
    sections.forEach(s => s.classList.remove('active'));
    t.classList.add('active');
    document.getElementById(t.dataset.tab).classList.add('active');
  }));

  // --- Render workouts ---
  const workoutWrap = document.getElementById('workouts');
  const today = new Date().toISOString().slice(0,10);
  const doneKey = "mb_done_" + today;
  const doneSet = new Set(JSON.parse(localStorage.getItem(doneKey) || "[]"));

  function saveDone() {
    localStorage.setItem(doneKey, JSON.stringify(Array.from(doneSet)));
  }

  workouts.forEach(w => {
    const card = document.createElement('div');
    card.className = 'card';
    const header = document.createElement('div');
    header.innerHTML = `<div class="title">${w.title}</div><div class="sub">${w.focus}</div>`;
    card.appendChild(header);

    w.exercises.forEach(ex => {
      const row = document.createElement('div');
      row.className = 'exercise';
      row.innerHTML = `<div><strong>${ex[0]}</strong><div class="small">${ex[1]} séries • ${ex[2]} reps ${ex[3] ? "• repos "+ex[3] : ""}</div></div>`;
      card.appendChild(row);
    });

    const toggle = document.createElement('button');
    toggle.className = 'btn';
    const key = w.key;
    const isDone = doneSet.has(key);
    toggle.textContent = isDone ? "Marquer non fait aujourd’hui" : "Marquer fait aujourd’hui";
    toggle.addEventListener('click', () => {
      if (doneSet.has(key)) { doneSet.delete(key); } else { doneSet.add(key); }
      saveDone();
      toggle.textContent = doneSet.has(key) ? "Marquer non fait aujourd’hui" : "Marquer fait aujourd’hui";
    });
    card.appendChild(toggle);
    workoutWrap.appendChild(card);
  });

  // --- Render meal plan ---
  const mealWrap = document.getElementById('mealplan');
  mealPlan.forEach(day => {
    const card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `<div class="title">${day[0]}</div>`;
    [day[1], day[2], day[3]].forEach(meal => {
      const box = document.createElement('div');
      box.className = 'card';
      box.style.background = '#121315';
      box.innerHTML = `<div class="title" style="font-size:16px">${meal[0]}</div>`;
      meal[1].forEach(line => {
        const p = document.createElement('div'); p.className='small'; p.textContent = "• " + line;
        box.appendChild(p);
      });
      card.appendChild(box);
    });
    mealWrap.appendChild(card);
  });

  // --- Shopping list ---
  const shopWrap = document.getElementById('shopping');
  const SHOP_KEY = "mb_shop_v1";
  let items = JSON.parse(localStorage.getItem(SHOP_KEY) || "null");
  if (!items) {
    items = shoppingDefaults.map(([name, qty]) => ({name, qty, checked:false}));
    localStorage.setItem(SHOP_KEY, JSON.stringify(items));
  }
  function renderShop() {
    shopWrap.innerHTML = "";
    items.forEach((it, idx) => {
      const card = document.createElement('div');
      card.className = 'card';
      const row = document.createElement('div');
      row.className = 'row';
      const cb = document.createElement('input');
      cb.type = 'checkbox'; cb.checked = !!it.checked;
      cb.addEventListener('change', () => { items[idx].checked = cb.checked; localStorage.setItem(SHOP_KEY, JSON.stringify(items)); });
      const label = document.createElement('div');
      label.innerHTML = `<div class="title" style="margin:0">${it.name}</div><div class="small">${it.qty}</div>`;
      row.appendChild(cb); row.appendChild(label);
      card.appendChild(row);
      shopWrap.appendChild(card);
    });
  }
  renderShop();
  document.getElementById('resetShop').addEventListener('click', () => {
    items.forEach(it => it.checked = false);
    localStorage.setItem(SHOP_KEY, JSON.stringify(items));
    renderShop();
  });

  // --- Progress logs ---
  const LOG_KEY = "mb_logs_v1";
  let logs = JSON.parse(localStorage.getItem(LOG_KEY) || "[]");
  const logsWrap = document.getElementById('logs');
  function renderLogs() {
    logsWrap.innerHTML = "";
    if (!logs.length) {
      const c = document.createElement('div'); c.className='card small'; c.textContent = "Ajoute ta première entrée pour suivre ta progression.";
      logsWrap.appendChild(c); return;
    }
    logs.forEach((log, i) => {
      const card = document.createElement('div'); card.className='card';
      const d = new Date(log.date);
      card.innerHTML = `<div class="title">${d.toLocaleDateString('fr-FR')}</div>
        <div class="small">Poids: ${log.bodyweight} kg</div>
        <div class="small">Bench: ${log.bench} • Squat: ${log.squat} • Deadlift: ${log.deadlift} • OHP: ${log.ohp}</div>
        <button class="btn ghost" data-i="${i}">Supprimer</button>`;
      logsWrap.appendChild(card);
    });
    logsWrap.querySelectorAll('button[data-i]').forEach(btn => {
      btn.addEventListener('click', e => {
        const i = parseInt(e.target.getAttribute('data-i'));
        logs.splice(i,1);
        localStorage.setItem(LOG_KEY, JSON.stringify(logs));
        renderLogs();
      });
    });
  }
  renderLogs();
  document.getElementById('saveLog').addEventListener('click', () => {
    const bw = parseFloat(document.getElementById('bw').value);
    const bench = parseFloat(document.getElementById('bench').value);
    const squat = parseFloat(document.getElementById('squat').value);
    const deadlift = parseFloat(document.getElementById('deadlift').value);
    const ohp = parseFloat(document.getElementById('ohp').value);
    if ([bw,bench,squat,deadlift,ohp].some(v => isNaN(v))) return;
    logs.unshift({date: new Date().toISOString(), bodyweight: bw, bench, squat, deadlift, ohp});
    localStorage.setItem(LOG_KEY, JSON.stringify(logs));
    document.querySelectorAll('#bw,#bench,#squat,#deadlift,#ohp').forEach(i => i.value="");
    renderLogs();
  });

  // --- PWA install ---
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('sw.js');
    });
  }
  </script>
</body>
</html>
